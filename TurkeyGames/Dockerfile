# Node 20ì„ ì‚¬ìš©í•œ ë¹Œë“œ ìŠ¤í…Œì´ì§€
FROM node:20 AS build

WORKDIR /app

COPY package*.json ./
RUN npm install
COPY . .

RUN npm run build

# Nginx í”„ë¡œë•ì…˜ ì´ë¯¸ì§€ë¡œ ì „í™˜
FROM nginx:alpine AS production

# ê°ê° ë”°ë¡œ ë³µì‚¬ (ğŸš¨ ì¤‘ìš”)
COPY --from=build /app/dist/dashboard /usr/share/nginx/html/dashboard
COPY --from=build /app/dist/gameboard /usr/share/nginx/html/gameboard

# ê¸°ë³¸ ì„¤ì • ì œê±° ë° ì»¤ìŠ¤í…€ ì„¤ì • ì ìš©
RUN rm /etc/nginx/conf.d/default.conf
COPY nginx/default.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
